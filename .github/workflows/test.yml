name: test

on:
  pull_request:
    branchs:
      - main
    paths:
      - "src/test/**"

jobs:
  git_diff_test:
    name: git diff test
    runs-on: ubuntu-latest
    if: github.event.pull_request.merged == true
    timeout-minutes: 20

    defaults:
      run:
        shell: bash
        working-directory: src
    
    steps:
      # マージブランチのチェックアウト（デフォはgithub.shaに向いてる）
      - name: Checkout Pull Request
        uses: actions/checkout@v3

      - name: Notice diff files
        run: |-
          diff=$(git diff --name-only origin/${{ github.event.pull_request.base.ref }}...origin/${{ github.event.pull_request.head.sha }})
          echo "::notice diff: ${diff}"